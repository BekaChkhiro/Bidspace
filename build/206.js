"use strict";(self.webpackChunkbrads_boilerplate_theme=self.webpackChunkbrads_boilerplate_theme||[]).push([[206],{2768:(e,t,a)=>{a.d(t,{A:()=>s});var r=a(1609),n=a(4740);const s=({postId:e,initialLikeCount:t=0,initialLiked:a=!1})=>{const[s,l]=(0,r.useState)(t),[o,c]=(0,r.useState)(a),[m,i]=(0,r.useState)(!1),{user:d}=(0,n.A)();return(0,r.createElement)("button",{onClick:async()=>{if(d&&!m){i(!0);try{const t=await fetch(`/wp-json/bidspace/v1/forum/${e}/like`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce}});if(!t.ok)throw new Error("Failed to toggle like");const a=await t.json();l(a.like_count),c(a.user_has_liked)}catch(e){console.error("Error toggling like:",e)}finally{i(!1)}}},disabled:!d||m,className:"flex items-center gap-2 hover:opacity-80 transition-opacity "+(d?"":"cursor-not-allowed opacity-50")},(0,r.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 "+(o?"text-red-500":"text-gray-400"),viewBox:"0 0 24 24",fill:o?"currentColor":"none",stroke:"currentColor",strokeWidth:"2"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})),(0,r.createElement)("span",{className:"text-sm "+(o?"text-red-500":"text-gray-500")},s))}},4206:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var r=a(1609),n=a.n(r),s=a(7767),l=a(4740),o=a(2768);const c=()=>{const{postId:e}=(0,s.g)(),[t,a]=n().useState(null),[c,m]=n().useState([]),[i,d]=n().useState(!0),[u,p]=n().useState(null),[f,b]=n().useState(""),[h,w]=n().useState(!1),[g,E]=n().useState(!1),{user:v}=(0,l.A)(),x=(0,s.Zp)();(0,r.useEffect)((()=>{(async()=>{try{const[t,r]=await Promise.all([fetch(`/wp-json/wp/v2/forum/${e}?_embed`),fetch(`/wp-json/wp/v2/comments?post=${e}&_embed&order=desc`)]);if(!t.ok)throw new Error("კითხვის ჩატვირთვა ვერ მოხერხდა");if(!r.ok)throw new Error("კომენტარების ჩატვირთვა ვერ მოხერხდა");const n=await t.json(),s=await r.json();if(a(n),m(s),!g)try{const t=await fetch(`/wp-json/bidspace/v1/forum/${e}/view`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce}});if(t.ok){const e=await t.json();a((t=>({...t,meta:{...t.meta,views_count:e.views_count}}))),E(!0)}}catch(e){console.error("Error incrementing view count:",e)}}catch(e){p(e.message)}finally{d(!1)}})()}),[e]);const y=e=>{const t=new Date(e),a=new Date,r=Math.floor((a-t)/1e3),n=Math.floor(r/60),s=Math.floor(n/60),l=Math.floor(s/24),o=Math.floor(l/30),c=Math.floor(l/365);return r<60?"წამის წინ":n<60?`${n} წუთის წინ`:s<24?`${s} საათის წინ`:l<30?`${l} დღის წინ`:o<12?`${o} თვის წინ`:`${c} წლის წინ`};return i?(0,r.createElement)("div",{className:"flex justify-center items-center min-h-[200px]"},(0,r.createElement)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})):u?(0,r.createElement)("div",{className:"bg-red-50 border border-red-200 text-red-600 rounded-lg p-4"},u):t?(0,r.createElement)("div",{className:"w-full"},(0,r.createElement)("article",{className:"bg-white shadow rounded-lg p-6 mb-6"},(0,r.createElement)("button",{onClick:()=>x(-1),className:"w-full pb-4 border-b mb-4 text-[#00aff0] flex items-center"},"← უკან დაბრუნება"),t.featured_image_url&&(0,r.createElement)("div",{className:"relative h-64 mb-6 overflow-hidden rounded-lg"},(0,r.createElement)("img",{src:t.featured_image_url,alt:t.title.rendered,className:"w-full h-full object-cover"})),t._embedded&&t._embedded["wp:term"]&&(0,r.createElement)("div",{className:"mb-4"},t._embedded["wp:term"][0].map((e=>{return(0,r.createElement)("span",{key:e.id,className:"inline-block bg-[#00aff0] text-white text-sm px-3 py-1 rounded-full mr-2"},{"cinema-theatre":"კინო-თეატრი",events:"ივენთები",sports:"სპორტი",travel:"მოგზაურობა"}[t=e.slug]||t);var t}))),(0,r.createElement)("h1",{className:"text-3xl font-bold mb-4",dangerouslySetInnerHTML:{__html:t.title.rendered}}),(0,r.createElement)("div",{className:"flex items-center justify-between mb-6 border-b border-gray-200 pb-4"},(0,r.createElement)("div",{className:"flex items-center space-x-4"},(0,r.createElement)("div",{className:"flex items-center"},t._embedded?.author?.[0]?.avatar_urls?.[48]&&(0,r.createElement)("img",{src:t._embedded.author[0].avatar_urls[48],alt:t._embedded.author[0].name,className:"w-10 h-10 rounded-full mr-3"}),(0,r.createElement)("div",null,(0,r.createElement)("div",{className:"font-medium"},t._embedded?.author?.[0]?.name),(0,r.createElement)("time",{className:"text-sm text-gray-500"},y(t.date))))),(0,r.createElement)("div",{className:"flex items-center space-x-6"},(0,r.createElement)("div",{className:"flex items-center text-gray-500"},(0,r.createElement)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})),(0,r.createElement)("span",null,t.meta?.views_count||0)),(0,r.createElement)(o.A,{postId:t.id,initialLikeCount:t.meta?.like_count||0,initialLiked:t.meta?.user_has_liked||!1}))),(0,r.createElement)("div",{className:"prose prose-lg max-w-none",dangerouslySetInnerHTML:{__html:t.content.rendered}})),(0,r.createElement)("div",{className:"bg-white shadow rounded-lg p-6"},(0,r.createElement)("h2",{className:"text-xl font-semibold mb-4"},"კომენტარები"),v?(0,r.createElement)("form",{onSubmit:async t=>{if(t.preventDefault(),v&&f.trim()){w(!0);try{const t=await fetch("/wp-json/wp/v2/comments",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce},body:JSON.stringify({post:parseInt(e),content:f,author:v.id})});if(!t.ok)throw new Error("კომენტარის დამატება ვერ მოხერხდა");const a=await t.json();m((e=>[a,...e])),b("")}catch(e){p(e.message)}finally{w(!1)}}},className:"mb-6"},(0,r.createElement)("textarea",{value:f,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#00aff0] focus:border-transparent",rows:"3",placeholder:"დაწერეთ კომენტარი...",required:!0}),(0,r.createElement)("div",{className:"flex justify-end mt-2"},(0,r.createElement)("button",{type:"submit",disabled:h||!f.trim(),className:"bg-[#00aff0] text-white py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 "+(h||!f.trim()?"opacity-50 cursor-not-allowed":"")},h?"იგზავნება...":"კომენტარის დამატება"))):(0,r.createElement)("div",{className:"mb-6 p-4 bg-gray-50 rounded-md text-center"},(0,r.createElement)("p",{className:"text-gray-600"},"კომენტარის დასატოვებლად გთხოვთ გაიაროთ ავტორიზაცია")),(0,r.createElement)("div",{className:"space-y-4"},0===c.length?(0,r.createElement)("p",{className:"text-gray-500 text-center py-4"},"კომენტარები არ არის"):c.map((e=>(0,r.createElement)("div",{key:e.id,className:"border-b border-gray-100 pb-4 last:border-0"},(0,r.createElement)("div",{className:"flex justify-between items-start mb-2"},(0,r.createElement)("div",{className:"flex items-center"},e._embedded?.author?.[0]?.avatar_urls?.[48]&&(0,r.createElement)("img",{src:e._embedded.author[0].avatar_urls[48],alt:e._embedded.author[0].name,className:"w-8 h-8 rounded-full mr-2"}),(0,r.createElement)("div",null,(0,r.createElement)("span",{className:"font-semibold text-gray-900"},e._embedded?.author?.[0]?.name),(0,r.createElement)("span",{className:"text-gray-500 text-sm ml-2"},y(e.date))))),(0,r.createElement)("div",{className:"prose prose-sm max-w-none text-gray-700 pl-10",dangerouslySetInnerHTML:{__html:e.content.rendered}}))))))):(0,r.createElement)("div",{className:"text-center p-8"},(0,r.createElement)("p",null,"პოსტი ვერ მოიძებნა"))}}}]);